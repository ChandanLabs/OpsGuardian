import { getStepAnswers } from "./getAnswers.mjs";
import { generateTemplate } from "./teamplateUtils.mjs";
import { generateOverride } from "./templates/ui/overrides.mjs";
import { getFileExtension } from "./utils.mjs";
import fs from "fs";
import path from "path";
import pc from "picocolors";

//#region src/create-step/index.ts
async function createStep(options) {
	try {
		const answers = await getStepAnswers();
		const stepDir = path.join(process.cwd(), "src", options?.stepFilePath || "");
		if (!fs.existsSync(stepDir)) fs.mkdirSync(stepDir, { recursive: true });
		const extension = getFileExtension(answers.language);
		const stepPath = path.join(stepDir, `${answers.name}${answers.type === "api" ? ".api" : ""}.step${extension}`);
		if (fs.existsSync(stepPath)) {
			console.error(pc.red(`\n‚ùå Error: Step file already exists at ${stepPath}`));
			process.exit(1);
		}
		const stepContent = await generateTemplate(answers);
		fs.writeFileSync(stepPath, stepContent);
		console.log(pc.green(`\n‚ú® Created step file at ${stepPath}`));
		if (answers.createOverride) {
			const overridePath = path.join(stepDir, `${answers.name}.step.tsx`);
			const overrideContent = await generateOverride(answers);
			fs.writeFileSync(overridePath, overrideContent);
			console.log(pc.green(`‚ú® Created UI override at ${overridePath}`));
		}
		console.log(pc.bold("\nüéâ Step creation complete!"));
	} catch (error) {
		console.error(pc.red("\n‚ùå Error creating step:"), error);
		process.exit(1);
	}
}

//#endregion
export { createStep };
//# sourceMappingURL=index.mjs.map