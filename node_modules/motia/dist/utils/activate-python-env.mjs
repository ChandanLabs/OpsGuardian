import { internalLogger } from "./internal-logger.mjs";
import { findPythonSitePackagesDir } from "./python-version-utils.mjs";
import path from "path";

//#region src/utils/activate-python-env.ts
const getSitePackagesPath = ({ baseDir, pythonVersion = "3.13" }) => {
	const venvPath = path.join(baseDir, "python_modules");
	const actualPythonVersionPath = findPythonSitePackagesDir(path.join(venvPath, "lib"), pythonVersion);
	return path.join(venvPath, "lib", actualPythonVersionPath, "site-packages");
};
const activatePythonVenv = ({ baseDir, isVerbose = false, pythonVersion = "3.13" }) => {
	internalLogger.info("Activating Python environment");
	const venvPath = path.join(baseDir, "python_modules");
	const venvBinPath = path.join(venvPath, process.platform === "win32" ? "Scripts" : "bin");
	const sitePackagesPath = getSitePackagesPath({
		baseDir,
		pythonVersion
	});
	process.env.PATH = `${venvBinPath}${path.delimiter}${process.env.PATH}`;
	process.env.VIRTUAL_ENV = venvPath;
	process.env.PYTHON_SITE_PACKAGES = sitePackagesPath;
	delete process.env.PYTHONHOME;
	if (isVerbose) {
		const pythonPath = process.platform === "win32" ? path.join(venvBinPath, "python.exe") : path.join(venvBinPath, "python");
		const relativePath = (path$1) => path$1.replace(baseDir, "<projectDir>");
		internalLogger.info("Using Python", relativePath(pythonPath));
		internalLogger.info("Site-packages path", relativePath(sitePackagesPath));
	}
};

//#endregion
export { activatePythonVenv, getSitePackagesPath };
//# sourceMappingURL=activate-python-env.mjs.map