{"version":3,"file":"install-lambda-python-packages.mjs","names":["error: any"],"sources":["../../src/utils/install-lambda-python-packages.ts"],"sourcesContent":["import { execSync } from 'child_process'\nimport fs from 'fs'\nimport { internalLogger } from './internal-logger'\n\ninterface VenvConfig {\n  requirementsList: string[]\n  isVerbose?: boolean\n}\n\nexport const installLambdaPythonPackages = ({ isVerbose = false, requirementsList }: VenvConfig): void => {\n  const sitePackagesPath = `${process.env.PYTHON_SITE_PACKAGES}-lambda`\n\n  for (const requirement of requirementsList) {\n    if (!fs.existsSync(requirement)) {\n      if (isVerbose) {\n        internalLogger.warn(`requirements.txt not found at ${requirement}`)\n      }\n      return\n    }\n\n    try {\n      // Install packages to lambda site-packages with platform specification\n      const command = `pip install -r \"${requirement}\" --target \"${sitePackagesPath}\" --platform manylinux2014_x86_64 --only-binary=:all: --upgrade --upgrade-strategy only-if-needed`\n\n      if (isVerbose) {\n        console.log('ðŸ“¦ Installing Python packages with platform specification...')\n        console.log('ðŸ“¦ Command:', command)\n      }\n\n      execSync(command, { stdio: 'inherit' })\n      internalLogger.info('Python packages for lambda installed successfully')\n    } catch (error: any) {\n      internalLogger.error('Failed to install Python packages for lambda', error.message)\n      throw error\n    }\n  }\n}\n"],"mappings":";;;;;AASA,MAAa,+BAA+B,EAAE,YAAY,OAAO,uBAAyC;CACxG,MAAM,mBAAmB,GAAG,QAAQ,IAAI,qBAAqB;AAE7D,MAAK,MAAM,eAAe,kBAAkB;AAC1C,MAAI,CAAC,GAAG,WAAW,YAAY,EAAE;AAC/B,OAAI,UACF,gBAAe,KAAK,iCAAiC,cAAc;AAErE;;AAGF,MAAI;GAEF,MAAM,UAAU,mBAAmB,YAAY,cAAc,iBAAiB;AAE9E,OAAI,WAAW;AACb,YAAQ,IAAI,+DAA+D;AAC3E,YAAQ,IAAI,eAAe,QAAQ;;AAGrC,YAAS,SAAS,EAAE,OAAO,WAAW,CAAC;AACvC,kBAAe,KAAK,oDAAoD;WACjEA,OAAY;AACnB,kBAAe,MAAM,gDAAgD,MAAM,QAAQ;AACnF,SAAM"}