{"version":3,"file":"python-version-utils.mjs","names":["error: any"],"sources":["../../src/utils/python-version-utils.ts"],"sourcesContent":["import fs from 'fs'\nimport path from 'path'\nimport { executeCommand } from './execute-command'\nimport { internalLogger } from './internal-logger'\n\nexport async function checkPythonVersionExists(pythonCmd: string, baseDir: string): Promise<boolean> {\n  try {\n    await executeCommand(`${pythonCmd} --version`, baseDir, { silent: true })\n    return true\n  } catch (error) {\n    return false\n  }\n}\n\nexport async function getPythonCommand(requestedVersion: string, baseDir: string): Promise<string> {\n  // Check if python{version} exists (e.g., python3.13)\n  const specificPythonCmd = `python${requestedVersion}`\n  if (await checkPythonVersionExists(specificPythonCmd, baseDir)) {\n    return specificPythonCmd\n  }\n\n  // Check if python exists and is version 3+\n  try {\n    const result = await executeCommand('python --version', baseDir, { silent: true })\n    const versionMatch = result.match(/Python\\s+(\\d+)\\.(\\d+)\\.(\\d+)/)\n    if (versionMatch && parseInt(versionMatch[1], 10) >= 3) {\n      return 'python'\n    }\n  } catch (error) {\n    // If error, python command doesn't exist or can't be executed\n  }\n\n  // Check if python3 exists\n  try {\n    const result = await executeCommand('python3 --version', baseDir, { silent: true })\n    const versionMatch = result.match(/Python\\s+(\\d+)\\.(\\d+)\\.(\\d+)/)\n    if (versionMatch && parseInt(versionMatch[1], 10) >= 3) {\n      return 'python3'\n    }\n  } catch (error) {\n    // If error, python3 command doesn't exist or can't be executed\n  }\n\n  throw new Error('No compatible Python 3 installation found. Please install Python 3.')\n}\n\nexport function findPythonSitePackagesDir(venvLibPath: string, pythonVersion: string): string {\n  let pythonVersionPath = `python${pythonVersion}`\n\n  if (!venvLibPath || !pythonVersion) {\n    return pythonVersionPath\n  }\n\n  try {\n    // Check if the exact version exists\n    if (venvLibPath && !fs.existsSync(path.join(venvLibPath, pythonVersionPath))) {\n      // Try to find any python3.x directory\n      const libContents = fs.readdirSync(venvLibPath)\n      const pythonDirs = libContents.filter((item) => item.startsWith('python3'))\n\n      if (pythonDirs.length > 0) {\n        // Use the first python3.x directory found\n        pythonVersionPath = pythonDirs[0]\n        internalLogger.info('Found Python directory', pythonVersionPath)\n      }\n    }\n  } catch (error: any) {\n    internalLogger.warn('Could not determine Python version directory', error.message)\n  }\n\n  return pythonVersionPath\n}\n"],"mappings":";;;;;;AAKA,eAAsB,yBAAyB,WAAmB,SAAmC;AACnG,KAAI;AACF,QAAM,eAAe,GAAG,UAAU,aAAa,SAAS,EAAE,QAAQ,MAAM,CAAC;AACzE,SAAO;UACA,OAAO;AACd,SAAO;;;AAIX,eAAsB,iBAAiB,kBAA0B,SAAkC;CAEjG,MAAM,oBAAoB,SAAS;AACnC,KAAI,MAAM,yBAAyB,mBAAmB,QAAQ,CAC5D,QAAO;AAIT,KAAI;EAEF,MAAM,gBADS,MAAM,eAAe,oBAAoB,SAAS,EAAE,QAAQ,MAAM,CAAC,EACtD,MAAM,+BAA+B;AACjE,MAAI,gBAAgB,SAAS,aAAa,IAAI,GAAG,IAAI,EACnD,QAAO;UAEF,OAAO;AAKhB,KAAI;EAEF,MAAM,gBADS,MAAM,eAAe,qBAAqB,SAAS,EAAE,QAAQ,MAAM,CAAC,EACvD,MAAM,+BAA+B;AACjE,MAAI,gBAAgB,SAAS,aAAa,IAAI,GAAG,IAAI,EACnD,QAAO;UAEF,OAAO;AAIhB,OAAM,IAAI,MAAM,sEAAsE;;AAGxF,SAAgB,0BAA0B,aAAqB,eAA+B;CAC5F,IAAI,oBAAoB,SAAS;AAEjC,KAAI,CAAC,eAAe,CAAC,cACnB,QAAO;AAGT,KAAI;AAEF,MAAI,eAAe,CAAC,GAAG,WAAW,KAAK,KAAK,aAAa,kBAAkB,CAAC,EAAE;GAG5E,MAAM,aADc,GAAG,YAAY,YAAY,CAChB,QAAQ,SAAS,KAAK,WAAW,UAAU,CAAC;AAE3E,OAAI,WAAW,SAAS,GAAG;AAEzB,wBAAoB,WAAW;AAC/B,mBAAe,KAAK,0BAA0B,kBAAkB;;;UAG7DA,OAAY;AACnB,iBAAe,KAAK,gDAAgD,MAAM,QAAQ;;AAGpF,QAAO"}