{"version":3,"file":"printer.mjs","names":[],"sources":["../../../../src/cloud/new-deployment/listeners/printer.ts"],"sourcesContent":["import { Printer } from '@motiadev/core'\nimport pc from 'picocolors'\nimport type { BuildStepConfig } from '../../build/builder'\nimport { CLIOutputManager, type Message } from '../../cli-output-manager'\nimport { projectDir } from '../constants'\n\nconst uploading = pc.yellow('➜ [UPLOADING]')\nconst uploaded = pc.green('✓ [UPLOADED]')\n\nexport class DeployPrinter {\n  private readonly printer = new Printer(projectDir)\n  private readonly output = new CLIOutputManager()\n\n  getLanguage(language: string): string {\n    if (language === 'node') {\n      return pc.bold(pc.green('Node'))\n    } else if (language === 'python') {\n      return pc.bold(pc.blue('Python'))\n    } else if (language === 'ruby') {\n      return pc.bold(pc.red('Ruby'))\n    }\n    return pc.bold(pc.gray('Unknown'))\n  }\n\n  getStepLanguage(stepConfig: BuildStepConfig): string {\n    if (stepConfig.filePath.endsWith('.py')) {\n      return this.getLanguage('python')\n    } else if (stepConfig.filePath.endsWith('.js') || stepConfig.filePath.endsWith('.ts')) {\n      return this.getLanguage('node')\n    } else if (stepConfig.filePath.endsWith('.rb')) {\n      return this.getLanguage('ruby')\n    }\n    return this.getLanguage('unknown')\n  }\n\n  getStepType(stepConfig: BuildStepConfig): string {\n    if (stepConfig.config.type === 'api') {\n      return pc.gray('(API)')\n    } else if (stepConfig.config.type === 'event') {\n      return pc.gray('(Event)')\n    } else if (stepConfig.config.type === 'cron') {\n      return pc.gray('(Cron)')\n    } else if (stepConfig.config.type === 'noop') {\n      return pc.gray('(Noop)')\n    }\n    return pc.gray('(Unknown)')\n  }\n\n  getRelativePath(path: string): string {\n    return pc.bold(pc.cyan(this.printer.getRelativePath(path)))\n  }\n\n  getStepPath(stepConfig: BuildStepConfig): string {\n    return this.getRelativePath(stepConfig.filePath)\n  }\n\n  printStepUploading(stepConfig: BuildStepConfig): void {\n    const stepLanguage = this.getStepLanguage(stepConfig)\n    const stepType = this.getStepType(stepConfig)\n    const stepPath = this.getStepPath(stepConfig)\n    const stepTag = this.printer.stepTag\n\n    this.output.log(stepConfig.filePath, (message: Message) => {\n      message.append(`${uploading} ${stepLanguage} ${stepTag} ${stepType} ${stepPath}`)\n    })\n  }\n\n  printStepUploaded(stepConfig: BuildStepConfig): void {\n    const stepLanguage = this.getStepLanguage(stepConfig)\n    const stepType = this.getStepType(stepConfig)\n    const stepPath = this.getStepPath(stepConfig)\n    const stepTag = this.printer.stepTag\n\n    this.output.log(stepConfig.filePath, (message: Message) => {\n      message.append(`${uploaded} ${stepLanguage} ${stepTag} ${stepType} ${stepPath}`)\n    })\n  }\n\n  printRouterUploading(language: string, routerPath: string): void {\n    const stepLanguage = this.getLanguage(language)\n    const stepPath = this.getRelativePath(routerPath)\n\n    this.output.log(routerPath, (message: Message) => message.append(`${uploading} ${stepLanguage} ${stepPath}`))\n  }\n\n  printRouterUploaded(language: string, routerPath: string): void {\n    const stepLanguage = this.getLanguage(language)\n    const stepPath = this.getRelativePath(routerPath)\n\n    this.output.log(routerPath, (message: Message) => message.append(`${uploaded} ${stepLanguage} ${stepPath}`))\n  }\n\n  printConfigurationUploading(): void {\n    this.output.log('upload-config', (message: Message) => message.tag('progress').append(`${uploading} Configuration`))\n  }\n\n  printConfigurationUploaded(): void {\n    this.output.log('upload-config', (message: Message) => message.tag('success').append(`${uploaded} Configuration`))\n  }\n}\n"],"mappings":";;;;;;AAMA,MAAM,YAAY,GAAG,OAAO,gBAAgB;AAC5C,MAAM,WAAW,GAAG,MAAM,eAAe;AAEzC,IAAa,gBAAb,MAA2B;;iBACE,IAAI,QAAQ,WAAW;gBACxB,IAAI,kBAAkB;;CAEhD,YAAY,UAA0B;AACpC,MAAI,aAAa,OACf,QAAO,GAAG,KAAK,GAAG,MAAM,OAAO,CAAC;WACvB,aAAa,SACtB,QAAO,GAAG,KAAK,GAAG,KAAK,SAAS,CAAC;WACxB,aAAa,OACtB,QAAO,GAAG,KAAK,GAAG,IAAI,OAAO,CAAC;AAEhC,SAAO,GAAG,KAAK,GAAG,KAAK,UAAU,CAAC;;CAGpC,gBAAgB,YAAqC;AACnD,MAAI,WAAW,SAAS,SAAS,MAAM,CACrC,QAAO,KAAK,YAAY,SAAS;WACxB,WAAW,SAAS,SAAS,MAAM,IAAI,WAAW,SAAS,SAAS,MAAM,CACnF,QAAO,KAAK,YAAY,OAAO;WACtB,WAAW,SAAS,SAAS,MAAM,CAC5C,QAAO,KAAK,YAAY,OAAO;AAEjC,SAAO,KAAK,YAAY,UAAU;;CAGpC,YAAY,YAAqC;AAC/C,MAAI,WAAW,OAAO,SAAS,MAC7B,QAAO,GAAG,KAAK,QAAQ;WACd,WAAW,OAAO,SAAS,QACpC,QAAO,GAAG,KAAK,UAAU;WAChB,WAAW,OAAO,SAAS,OACpC,QAAO,GAAG,KAAK,SAAS;WACf,WAAW,OAAO,SAAS,OACpC,QAAO,GAAG,KAAK,SAAS;AAE1B,SAAO,GAAG,KAAK,YAAY;;CAG7B,gBAAgB,MAAsB;AACpC,SAAO,GAAG,KAAK,GAAG,KAAK,KAAK,QAAQ,gBAAgB,KAAK,CAAC,CAAC;;CAG7D,YAAY,YAAqC;AAC/C,SAAO,KAAK,gBAAgB,WAAW,SAAS;;CAGlD,mBAAmB,YAAmC;EACpD,MAAM,eAAe,KAAK,gBAAgB,WAAW;EACrD,MAAM,WAAW,KAAK,YAAY,WAAW;EAC7C,MAAM,WAAW,KAAK,YAAY,WAAW;EAC7C,MAAM,UAAU,KAAK,QAAQ;AAE7B,OAAK,OAAO,IAAI,WAAW,WAAW,YAAqB;AACzD,WAAQ,OAAO,GAAG,UAAU,GAAG,aAAa,GAAG,QAAQ,GAAG,SAAS,GAAG,WAAW;IACjF;;CAGJ,kBAAkB,YAAmC;EACnD,MAAM,eAAe,KAAK,gBAAgB,WAAW;EACrD,MAAM,WAAW,KAAK,YAAY,WAAW;EAC7C,MAAM,WAAW,KAAK,YAAY,WAAW;EAC7C,MAAM,UAAU,KAAK,QAAQ;AAE7B,OAAK,OAAO,IAAI,WAAW,WAAW,YAAqB;AACzD,WAAQ,OAAO,GAAG,SAAS,GAAG,aAAa,GAAG,QAAQ,GAAG,SAAS,GAAG,WAAW;IAChF;;CAGJ,qBAAqB,UAAkB,YAA0B;EAC/D,MAAM,eAAe,KAAK,YAAY,SAAS;EAC/C,MAAM,WAAW,KAAK,gBAAgB,WAAW;AAEjD,OAAK,OAAO,IAAI,aAAa,YAAqB,QAAQ,OAAO,GAAG,UAAU,GAAG,aAAa,GAAG,WAAW,CAAC;;CAG/G,oBAAoB,UAAkB,YAA0B;EAC9D,MAAM,eAAe,KAAK,YAAY,SAAS;EAC/C,MAAM,WAAW,KAAK,gBAAgB,WAAW;AAEjD,OAAK,OAAO,IAAI,aAAa,YAAqB,QAAQ,OAAO,GAAG,SAAS,GAAG,aAAa,GAAG,WAAW,CAAC;;CAG9G,8BAAoC;AAClC,OAAK,OAAO,IAAI,kBAAkB,YAAqB,QAAQ,IAAI,WAAW,CAAC,OAAO,GAAG,UAAU,gBAAgB,CAAC;;CAGtH,6BAAmC;AACjC,OAAK,OAAO,IAAI,kBAAkB,YAAqB,QAAQ,IAAI,UAAU,CAAC,OAAO,GAAG,SAAS,gBAAgB,CAAC"}