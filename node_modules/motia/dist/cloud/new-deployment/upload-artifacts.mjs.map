{"version":3,"file":"upload-artifacts.mjs","names":[],"sources":["../../../src/cloud/new-deployment/upload-artifacts.ts"],"sourcesContent":["import type { Builder } from '../build/builder'\nimport type { UploadListener } from './listeners/listener.types'\nimport { upload } from './utils/upload'\n\nexport const uploadArtifacts = async (\n  builder: Builder,\n  deploymentToken: string,\n  listener: UploadListener,\n): Promise<void> => {\n  const stepEntries = Object.entries(builder.stepsConfig)\n  const routerEntries = Object.entries(builder.routersConfig)\n\n  await Promise.all([\n    ...stepEntries.map(async ([stepPath, stepConfig]) => {\n      listener.stepUploadStart(stepPath, stepConfig)\n      await upload(deploymentToken, stepPath, (progress: number) => {\n        listener.stepUploadProgress(stepPath, stepConfig, progress)\n      })\n      listener.stepUploadEnd(stepPath, stepConfig)\n    }),\n    ...routerEntries.map(async ([language, routerPath]) => {\n      listener.routeUploadStart(routerPath, language)\n      await upload(deploymentToken, routerPath, (progress: number) => {\n        listener.routeUploadProgress(routerPath, language, progress)\n      })\n      listener.routeUploadEnd(routerPath, language)\n    }),\n  ])\n}\n"],"mappings":";;;AAIA,MAAa,kBAAkB,OAC7B,SACA,iBACA,aACkB;CAClB,MAAM,cAAc,OAAO,QAAQ,QAAQ,YAAY;CACvD,MAAM,gBAAgB,OAAO,QAAQ,QAAQ,cAAc;AAE3D,OAAM,QAAQ,IAAI,CAChB,GAAG,YAAY,IAAI,OAAO,CAAC,UAAU,gBAAgB;AACnD,WAAS,gBAAgB,UAAU,WAAW;AAC9C,QAAM,OAAO,iBAAiB,WAAW,aAAqB;AAC5D,YAAS,mBAAmB,UAAU,YAAY,SAAS;IAC3D;AACF,WAAS,cAAc,UAAU,WAAW;GAC5C,EACF,GAAG,cAAc,IAAI,OAAO,CAAC,UAAU,gBAAgB;AACrD,WAAS,iBAAiB,YAAY,SAAS;AAC/C,QAAM,OAAO,iBAAiB,aAAa,aAAqB;AAC9D,YAAS,oBAAoB,YAAY,UAAU,SAAS;IAC5D;AACF,WAAS,eAAe,YAAY,SAAS;GAC7C,CACH,CAAC"}