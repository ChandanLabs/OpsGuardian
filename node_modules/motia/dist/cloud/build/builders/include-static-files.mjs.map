{"version":3,"file":"include-static-files.mjs","names":[],"sources":["../../../../src/cloud/build/builders/include-static-files.ts"],"sourcesContent":["import type { Step } from '@motiadev/core'\nimport fs from 'fs'\nimport { globSync } from 'glob'\nimport path from 'path'\nimport type { Builder } from '../builder'\nimport type { Archiver } from './archiver'\n\nexport const includeStaticFiles = (steps: Step[], builder: Builder, archive: Archiver) => {\n  for (const step of steps) {\n    if ('includeFiles' in step.config) {\n      const staticFiles = step.config.includeFiles\n\n      if (!staticFiles || !Array.isArray(staticFiles) || staticFiles.length === 0) {\n        continue\n      }\n\n      staticFiles.forEach((file) => {\n        const matches = globSync(file, { cwd: path.dirname(step.filePath), absolute: true })\n        matches.forEach((filePath: string) => {\n          const relativeFilePath = path.relative(builder.projectDir, filePath)\n          const content = fs.readFileSync(filePath)\n          archive.append(content, relativeFilePath)\n        })\n      })\n    }\n  }\n}\n"],"mappings":";;;;;AAOA,MAAa,sBAAsB,OAAe,SAAkB,YAAsB;AACxF,MAAK,MAAM,QAAQ,MACjB,KAAI,kBAAkB,KAAK,QAAQ;EACjC,MAAM,cAAc,KAAK,OAAO;AAEhC,MAAI,CAAC,eAAe,CAAC,MAAM,QAAQ,YAAY,IAAI,YAAY,WAAW,EACxE;AAGF,cAAY,SAAS,SAAS;AAE5B,GADgB,SAAS,MAAM;IAAE,KAAK,KAAK,QAAQ,KAAK,SAAS;IAAE,UAAU;IAAM,CAAC,CAC5E,SAAS,aAAqB;IACpC,MAAM,mBAAmB,KAAK,SAAS,QAAQ,YAAY,SAAS;IACpE,MAAM,UAAU,GAAG,aAAa,SAAS;AACzC,YAAQ,OAAO,SAAS,iBAAiB;KACzC;IACF"}