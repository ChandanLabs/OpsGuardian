{"version":3,"file":"api-endpoints.validator.mjs","names":["apiEndpointsValidator: Validator"],"sources":["../../../../src/cloud/build/validations/api-endpoints.validator.ts"],"sourcesContent":["import path from 'path'\nimport pc from 'picocolors'\nimport type { Validator } from './types'\n\nexport const apiEndpointsValidator: Validator = (builder) => {\n  const errors = []\n  const endpoints = new Map<string, string>()\n\n  for (const step of Object.values(builder.stepsConfig)) {\n    if (step.config.type === 'api') {\n      const relativePath = path.relative(builder.projectDir, step.filePath)\n      const entrypoint = path.relative(builder.projectDir, step.filePath)\n      const endpoint = `${step.config.method} ${step.config.path}`\n\n      if (endpoints.has(endpoint)) {\n        errors.push({\n          relativePath,\n          message: [\n            `Endpoint conflict`,\n            `  ${pc.red('➜')} ${pc.magenta(endpoint)} is defined in the following files`,\n            `    ${pc.red('➜')} ${pc.blue(entrypoint)}`,\n            `    ${pc.red('➜')} ${pc.blue(endpoints.get(endpoint)!)}`,\n          ].join('\\n'),\n          step,\n        })\n      } else {\n        endpoints.set(endpoint, entrypoint)\n      }\n    }\n  }\n\n  return { errors, warnings: [] }\n}\n"],"mappings":";;;;AAIA,MAAaA,yBAAoC,YAAY;CAC3D,MAAM,SAAS,EAAE;CACjB,MAAM,4BAAY,IAAI,KAAqB;AAE3C,MAAK,MAAM,QAAQ,OAAO,OAAO,QAAQ,YAAY,CACnD,KAAI,KAAK,OAAO,SAAS,OAAO;EAC9B,MAAM,eAAe,KAAK,SAAS,QAAQ,YAAY,KAAK,SAAS;EACrE,MAAM,aAAa,KAAK,SAAS,QAAQ,YAAY,KAAK,SAAS;EACnE,MAAM,WAAW,GAAG,KAAK,OAAO,OAAO,GAAG,KAAK,OAAO;AAEtD,MAAI,UAAU,IAAI,SAAS,CACzB,QAAO,KAAK;GACV;GACA,SAAS;IACP;IACA,KAAK,GAAG,IAAI,IAAI,CAAC,GAAG,GAAG,QAAQ,SAAS,CAAC;IACzC,OAAO,GAAG,IAAI,IAAI,CAAC,GAAG,GAAG,KAAK,WAAW;IACzC,OAAO,GAAG,IAAI,IAAI,CAAC,GAAG,GAAG,KAAK,UAAU,IAAI,SAAS,CAAE;IACxD,CAAC,KAAK,KAAK;GACZ;GACD,CAAC;MAEF,WAAU,IAAI,UAAU,WAAW;;AAKzC,QAAO;EAAE;EAAQ,UAAU,EAAE;EAAE"}