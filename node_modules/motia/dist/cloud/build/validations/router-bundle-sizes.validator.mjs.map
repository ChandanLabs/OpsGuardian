{"version":3,"file":"router-bundle-sizes.validator.mjs","names":["routerBundleSizesValidator: Validator"],"sources":["../../../../src/cloud/build/validations/router-bundle-sizes.validator.ts"],"sourcesContent":["import pc from 'picocolors'\nimport { BUNDLE_SIZE_LIMITS, BYTES_TO_MB } from './constants'\nimport type { Validator } from './types'\n\nexport const routerBundleSizesValidator: Validator = (builder) => {\n  const errors = []\n  const maxRouterSize = BUNDLE_SIZE_LIMITS.ROUTER_MAX_MB * BYTES_TO_MB\n\n  for (const [routerType, uncompressedSize] of builder.routerUncompressedSizes.entries()) {\n    if (uncompressedSize > maxRouterSize) {\n      const uncompressedSizeMB = (uncompressedSize / BYTES_TO_MB).toFixed(2)\n      const compressedSize = builder.routerCompressedSizes.get(routerType)\n      const compressedSizeMB = compressedSize ? (compressedSize / BYTES_TO_MB).toFixed(2) : 'unknown'\n\n      errors.push({\n        relativePath: `${routerType} API router`,\n        message: [\n          `${routerType.charAt(0).toUpperCase() + routerType.slice(1)} API router bundle size exceeds ${BUNDLE_SIZE_LIMITS.ROUTER_MAX_MB}MB limit (uncompressed).`,\n          `  ${pc.red('➜')} Uncompressed size: ${pc.magenta(uncompressedSizeMB + 'MB')}`,\n          `  ${pc.red('➜')} Compressed size: ${pc.cyan(compressedSizeMB + 'MB')}`,\n          `  ${pc.red('➜')} Maximum allowed: ${pc.blue(BUNDLE_SIZE_LIMITS.ROUTER_MAX_MB + 'MB')}`,\n        ].join('\\n'),\n        step: Object.values(builder.stepsConfig)[0],\n      })\n    }\n  }\n\n  return { errors, warnings: [] }\n}\n"],"mappings":";;;;AAIA,MAAaA,8BAAyC,YAAY;CAChE,MAAM,SAAS,EAAE;CACjB,MAAM,gBAAgB,mBAAmB,gBAAgB;AAEzD,MAAK,MAAM,CAAC,YAAY,qBAAqB,QAAQ,wBAAwB,SAAS,CACpF,KAAI,mBAAmB,eAAe;EACpC,MAAM,sBAAsB,mBAAmB,aAAa,QAAQ,EAAE;EACtE,MAAM,iBAAiB,QAAQ,sBAAsB,IAAI,WAAW;EACpE,MAAM,mBAAmB,kBAAkB,iBAAiB,aAAa,QAAQ,EAAE,GAAG;AAEtF,SAAO,KAAK;GACV,cAAc,GAAG,WAAW;GAC5B,SAAS;IACP,GAAG,WAAW,OAAO,EAAE,CAAC,aAAa,GAAG,WAAW,MAAM,EAAE,CAAC,kCAAkC,mBAAmB,cAAc;IAC/H,KAAK,GAAG,IAAI,IAAI,CAAC,sBAAsB,GAAG,QAAQ,qBAAqB,KAAK;IAC5E,KAAK,GAAG,IAAI,IAAI,CAAC,oBAAoB,GAAG,KAAK,mBAAmB,KAAK;IACrE,KAAK,GAAG,IAAI,IAAI,CAAC,oBAAoB,GAAG,KAAK,mBAAmB,gBAAgB,KAAK;IACtF,CAAC,KAAK,KAAK;GACZ,MAAM,OAAO,OAAO,QAAQ,YAAY,CAAC;GAC1C,CAAC;;AAIN,QAAO;EAAE;EAAQ,UAAU,EAAE;EAAE"}