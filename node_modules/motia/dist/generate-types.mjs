import { getStepFiles, getStreamFiles } from "./generate-locked-data.mjs";
import { LockedData, MemoryStreamAdapterManager, Printer, getStepConfig, getStreamConfig } from "@motiadev/core";
import { randomUUID } from "crypto";
import pc from "picocolors";

//#region src/generate-types.ts
const version = `${randomUUID()}:${Math.floor(Date.now() / 1e3)}`;
const generateTypes = async (projectDir) => {
	const files = getStepFiles(projectDir);
	const streamsFiles = getStreamFiles(projectDir);
	const lockedData = new LockedData(projectDir, new MemoryStreamAdapterManager(), new Printer(projectDir));
	for (const filePath of files) {
		const config = await getStepConfig(filePath, projectDir);
		if (config) lockedData.createStep({
			filePath,
			version,
			config
		}, { disableTypeCreation: true });
	}
	for (const filePath of streamsFiles) {
		const config = await getStreamConfig(filePath, projectDir);
		if (config) lockedData.createStream({
			filePath,
			config
		}, { disableTypeCreation: true });
	}
	lockedData.saveTypes();
	console.log(`${pc.green("âœ“ [SUCCESS]")} Types generated`);
};

//#endregion
export { generateTypes };
//# sourceMappingURL=generate-types.mjs.map