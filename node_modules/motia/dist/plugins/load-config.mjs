import { installPluginDependencies } from "./install-plugin-dependencies.mjs";
import { globSync } from "glob";
import { createJiti } from "jiti";
import fs from "node:fs";
import path from "node:path";
import { fileURLToPath } from "node:url";

//#region src/plugins/load-config.ts
const __dirname = path.dirname(fileURLToPath(import.meta.url));
const jiti = createJiti(import.meta.url);
const loadConfig = async (baseDir, printer) => {
	const configFiles = globSync("motia.config.{ts,js}", {
		absolute: true,
		cwd: baseDir
	});
	if (configFiles.length === 0) {
		const templatePath = path.join(__dirname, "../create/templates/nodejs/motia.config.ts.txt");
		const templateContent = fs.readFileSync(templatePath, "utf-8");
		const configPath = path.join(baseDir, "motia.config.ts");
		fs.writeFileSync(configPath, templateContent);
		printer.printPluginLog("Created motia.config.ts");
		await installPluginDependencies(baseDir, printer);
		return await jiti.import(configPath, { default: true });
	}
	return await jiti.import(configFiles[0], { default: true });
};

//#endregion
export { loadConfig };
//# sourceMappingURL=load-config.mjs.map