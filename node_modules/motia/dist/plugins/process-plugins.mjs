import { createPluginContext } from "./create-plugin-context.mjs";
import { loadConfig } from "./load-config.mjs";
import { processSteps } from "./process-steps.mjs";

//#region src/plugins/process-plugins.ts
const processPlugins = async (motiaServer) => {
	const { printer, motia } = motiaServer;
	const baseDir = motia.lockedData.baseDir;
	const context = createPluginContext(motiaServer);
	const appConfig = await loadConfig(baseDir, printer);
	if (!appConfig?.plugins) {
		printer.printPluginError("No plugins found in motia.config.ts");
		return [];
	}
	const plugins = appConfig.plugins?.flatMap((item) => item(context)) || [];
	await processSteps(motiaServer, plugins, baseDir);
	return plugins;
};

//#endregion
export { processPlugins };
//# sourceMappingURL=process-plugins.mjs.map