{"version":3,"file":"collect-plugin-steps.mjs","names":["pluginSteps: Array<{ filePath: string; config: StepConfig }>"],"sources":["../../src/plugins/collect-plugin-steps.ts"],"sourcesContent":["import fs from 'node:fs'\nimport { getStepConfig, type Printer, type StepConfig } from '@motiadev/core'\nimport { globSync } from 'glob'\n\nexport const collectPluginSteps = async (\n  dirname: string,\n  stepPatterns: string[],\n  projectRoot: string,\n  printer: Printer,\n): Promise<Array<{ filePath: string; config: StepConfig }>> => {\n  const pluginSteps: Array<{ filePath: string; config: StepConfig }> = []\n\n  if (!fs.existsSync(dirname)) {\n    printer.printPluginWarn(`Directory not found: ${dirname}`)\n    return pluginSteps\n  }\n\n  for (const pattern of stepPatterns) {\n    try {\n      const stepFiles = globSync(pattern, { absolute: true, cwd: dirname })\n\n      if (stepFiles.length === 0) {\n        printer.printPluginLog(`No files found matching pattern: ${pattern} in ${dirname}`)\n        continue\n      }\n\n      for (const filePath of stepFiles) {\n        try {\n          const config = await getStepConfig(filePath, projectRoot)\n          if (config) {\n            pluginSteps.push({ filePath, config })\n          } else {\n            printer.printPluginWarn(`No config found in step ${filePath}, step skipped`)\n          }\n        } catch (error) {\n          printer.printPluginError(`Error loading step ${filePath}:`, error)\n        }\n      }\n    } catch (error) {\n      printer.printPluginError(`Error processing pattern ${pattern}:`, error)\n    }\n  }\n\n  return pluginSteps\n}\n"],"mappings":";;;;;AAIA,MAAa,qBAAqB,OAChC,SACA,cACA,aACA,YAC6D;CAC7D,MAAMA,cAA+D,EAAE;AAEvE,KAAI,CAAC,GAAG,WAAW,QAAQ,EAAE;AAC3B,UAAQ,gBAAgB,wBAAwB,UAAU;AAC1D,SAAO;;AAGT,MAAK,MAAM,WAAW,aACpB,KAAI;EACF,MAAM,YAAY,SAAS,SAAS;GAAE,UAAU;GAAM,KAAK;GAAS,CAAC;AAErE,MAAI,UAAU,WAAW,GAAG;AAC1B,WAAQ,eAAe,oCAAoC,QAAQ,MAAM,UAAU;AACnF;;AAGF,OAAK,MAAM,YAAY,UACrB,KAAI;GACF,MAAM,SAAS,MAAM,cAAc,UAAU,YAAY;AACzD,OAAI,OACF,aAAY,KAAK;IAAE;IAAU;IAAQ,CAAC;OAEtC,SAAQ,gBAAgB,2BAA2B,SAAS,gBAAgB;WAEvE,OAAO;AACd,WAAQ,iBAAiB,sBAAsB,SAAS,IAAI,MAAM;;UAG/D,OAAO;AACd,UAAQ,iBAAiB,4BAA4B,QAAQ,IAAI,MAAM;;AAI3E,QAAO"}