{"version":3,"file":"utils.mjs","names":[],"sources":["../../src/redis/utils.ts"],"sourcesContent":["import type { RedisConfig } from '@motiadev/core'\nimport type { LoadedMotiaConfig } from '../load-motia-config'\n\nexport const shouldUseMemoryServer = (config: LoadedMotiaConfig): boolean => {\n  if (process.env.MOTIA_DISABLE_MEMORY_SERVER === 'true') {\n    return false\n  }\n\n  if (process.env.MOTIA_REDIS_HOST && process.env.MOTIA_REDIS_HOST !== '127.0.0.1') {\n    return false\n  }\n\n  const redisConfig = config.redis\n  if (redisConfig && 'useMemoryServer' in redisConfig && redisConfig.useMemoryServer === false) {\n    return false\n  }\n\n  return redisConfig?.useMemoryServer !== undefined ? redisConfig.useMemoryServer === true : true\n}\n\nexport const isExternalRedisConfig = (\n  redisConfig: RedisConfig | undefined,\n): redisConfig is Extract<RedisConfig, { useMemoryServer?: false; host: string; port: number }> => {\n  return redisConfig !== undefined && 'host' in redisConfig && 'port' in redisConfig\n}\n"],"mappings":";AAGA,MAAa,yBAAyB,WAAuC;AAC3E,KAAI,QAAQ,IAAI,gCAAgC,OAC9C,QAAO;AAGT,KAAI,QAAQ,IAAI,oBAAoB,QAAQ,IAAI,qBAAqB,YACnE,QAAO;CAGT,MAAM,cAAc,OAAO;AAC3B,KAAI,eAAe,qBAAqB,eAAe,YAAY,oBAAoB,MACrF,QAAO;AAGT,QAAO,aAAa,oBAAoB,SAAY,YAAY,oBAAoB,OAAO;;AAG7F,MAAa,yBACX,gBACiG;AACjG,QAAO,gBAAgB,UAAa,UAAU,eAAe,UAAU"}