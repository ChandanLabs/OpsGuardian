{"version":3,"file":"flows-config-endpoint.mjs","names":["newFlowConfig: FlowConfig"],"sources":["../../../src/endpoints/flows-config-endpoint.ts"],"sourcesContent":["import type { Express, Request, Response } from 'express'\nimport path from 'path'\nimport { z } from 'zod'\nimport type { LockedData } from '../locked-data'\nimport { FlowsConfigStream } from '../streams/flows-config-stream'\nimport type { FlowConfig } from '../types/flows-config-types'\n\ninterface ParamId {\n  id: string\n}\n\nexport const flowsConfigEndpoint = (app: Express, baseDir: string, lockedData: LockedData) => {\n  const configPath = path.join(baseDir, 'motia-workbench.json')\n  const stream = new FlowsConfigStream(configPath)\n\n  lockedData.createStream(\n    {\n      filePath: '__motia.flowsConfig',\n      hidden: true,\n      config: {\n        name: '__motia.flowsConfig',\n        schema: z.object({ name: z.string(), steps: z.any(), edges: z.any() }),\n        baseConfig: { storageType: 'custom', factory: () => stream },\n      },\n    },\n    { disableTypeCreation: true },\n  )()\n\n  app.post('/__motia/flows/:id/config', async (req: Request<ParamId>, res: Response) => {\n    const newFlowConfig: FlowConfig = req.body\n    try {\n      await stream.set('default', newFlowConfig.id, newFlowConfig)\n      res.status(200).send({ message: 'Flow config saved successfully' })\n    } catch (error) {\n      console.error('Error saving flow config:', (error as Error).message)\n      res.status(500).json({ error: 'Failed to save flow config' })\n    }\n  })\n}\n"],"mappings":";;;;;AAWA,MAAa,uBAAuB,KAAc,SAAiB,eAA2B;CAE5F,MAAM,SAAS,IAAI,kBADA,KAAK,KAAK,SAAS,uBAAuB,CACb;AAEhD,YAAW,aACT;EACE,UAAU;EACV,QAAQ;EACR,QAAQ;GACN,MAAM;GACN,QAAQ,EAAE,OAAO;IAAE,MAAM,EAAE,QAAQ;IAAE,OAAO,EAAE,KAAK;IAAE,OAAO,EAAE,KAAK;IAAE,CAAC;GACtE,YAAY;IAAE,aAAa;IAAU,eAAe;IAAQ;GAC7D;EACF,EACD,EAAE,qBAAqB,MAAM,CAC9B,EAAE;AAEH,KAAI,KAAK,6BAA6B,OAAO,KAAuB,QAAkB;EACpF,MAAMA,gBAA4B,IAAI;AACtC,MAAI;AACF,SAAM,OAAO,IAAI,WAAW,cAAc,IAAI,cAAc;AAC5D,OAAI,OAAO,IAAI,CAAC,KAAK,EAAE,SAAS,kCAAkC,CAAC;WAC5D,OAAO;AACd,WAAQ,MAAM,6BAA8B,MAAgB,QAAQ;AACpE,OAAI,OAAO,IAAI,CAAC,KAAK,EAAE,OAAO,8BAA8B,CAAC;;GAE/D"}