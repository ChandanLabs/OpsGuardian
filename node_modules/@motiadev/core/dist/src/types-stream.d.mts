import { StreamFactory } from "./streams/stream-factory.mjs";
import { StepSchemaInput } from "./types.mjs";

//#region src/types-stream.d.ts
type StreamSubscription = {
  groupId: string;
  id?: string;
};
interface StreamConfig {
  name: string;
  schema: StepSchemaInput;
  baseConfig: {
    storageType: 'default';
  } | {
    storageType: 'custom';
    factory: () => MotiaStream<any>;
  };
  canAccess?: (subscription: StreamSubscription, authContext: any) => boolean | Promise<boolean>;
}
type StateStreamEventChannel = {
  groupId: string;
  id?: string;
};
type StateStreamEvent<TData> = {
  type: string;
  data: TData;
};
type BaseStreamItem<TData = unknown> = TData & {
  id: string;
};
type Stream<TConfig extends StreamConfig = StreamConfig> = {
  filePath: string;
  config: TConfig;
  hidden?: boolean;
  factory: StreamFactory<unknown>;
};
interface MotiaStream<TData> {
  get(groupId: string, id: string): Promise<BaseStreamItem<TData> | null>;
  set(groupId: string, id: string, data: TData): Promise<BaseStreamItem<TData>>;
  delete(groupId: string, id: string): Promise<BaseStreamItem<TData> | null>;
  getGroup(groupId: string): Promise<BaseStreamItem<TData>[]>;
  send<T>(channel: StateStreamEventChannel, event: StateStreamEvent<T>): Promise<void>;
}
//#endregion
export { BaseStreamItem, MotiaStream, StateStreamEvent, StateStreamEventChannel, Stream, StreamConfig, StreamSubscription };
//# sourceMappingURL=types-stream.d.mts.map