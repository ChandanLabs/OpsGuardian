{"version":3,"file":"get-config.mjs","names":["filePath"],"sources":["../../../src/node/get-config.ts"],"sourcesContent":["import path from 'node:path'\nimport { pathToFileURL } from 'node:url'\nimport { type SchemaInput, schemaToJsonSchema } from '../schema-utils'\n\nasync function getConfig(filePath: string) {\n  try {\n    const importedModule = await import(pathToFileURL(path.resolve(filePath)).href)\n    const config = importedModule.config || importedModule.default?.config\n\n    if (!config) {\n      throw new Error(`Config not found in module ${filePath}`)\n    }\n\n    if (config.input) {\n      const converted = schemaToJsonSchema(config.input)\n      if (converted) {\n        config.input = converted\n      }\n    }\n\n    if (config.bodySchema) {\n      const converted = schemaToJsonSchema(config.bodySchema)\n      if (converted) {\n        config.bodySchema = converted\n      }\n    }\n\n    if (config.responseSchema) {\n      for (const [status, schema] of Object.entries(config.responseSchema)) {\n        const converted = schemaToJsonSchema(schema as SchemaInput)\n        if (converted) {\n          config.responseSchema[status] = converted\n        }\n      }\n    }\n\n    if (config.schema) {\n      const converted = schemaToJsonSchema(config.schema)\n      if (converted) {\n        config.schema = converted\n      }\n    }\n\n    if (typeof config.canAccess === 'function') {\n      config.__motia_hasCanAccess = !!config.canAccess\n      delete config.canAccess\n    }\n\n    process.send?.(config)\n\n    process.exit(0)\n  } catch (error) {\n    console.error('Error running TypeScript module:', error)\n    process.exit(1)\n  }\n}\n\nconst [, , filePath] = process.argv\n\nif (!filePath) {\n  console.error('Usage: node get-config.mjs <file-path>')\n  process.exit(1)\n}\n\ngetConfig(filePath).catch((err) => {\n  console.error('Error:', err)\n  process.exit(1)\n})\n"],"mappings":";;;;;AAIA,eAAe,UAAU,YAAkB;AACzC,KAAI;EACF,MAAM,iBAAiB,MAAM,OAAO,cAAc,KAAK,QAAQA,WAAS,CAAC,CAAC;EAC1E,MAAM,SAAS,eAAe,UAAU,eAAe,SAAS;AAEhE,MAAI,CAAC,OACH,OAAM,IAAI,MAAM,8BAA8BA,aAAW;AAG3D,MAAI,OAAO,OAAO;GAChB,MAAM,YAAY,mBAAmB,OAAO,MAAM;AAClD,OAAI,UACF,QAAO,QAAQ;;AAInB,MAAI,OAAO,YAAY;GACrB,MAAM,YAAY,mBAAmB,OAAO,WAAW;AACvD,OAAI,UACF,QAAO,aAAa;;AAIxB,MAAI,OAAO,eACT,MAAK,MAAM,CAAC,QAAQ,WAAW,OAAO,QAAQ,OAAO,eAAe,EAAE;GACpE,MAAM,YAAY,mBAAmB,OAAsB;AAC3D,OAAI,UACF,QAAO,eAAe,UAAU;;AAKtC,MAAI,OAAO,QAAQ;GACjB,MAAM,YAAY,mBAAmB,OAAO,OAAO;AACnD,OAAI,UACF,QAAO,SAAS;;AAIpB,MAAI,OAAO,OAAO,cAAc,YAAY;AAC1C,UAAO,uBAAuB,CAAC,CAAC,OAAO;AACvC,UAAO,OAAO;;AAGhB,UAAQ,OAAO,OAAO;AAEtB,UAAQ,KAAK,EAAE;UACR,OAAO;AACd,UAAQ,MAAM,oCAAoC,MAAM;AACxD,UAAQ,KAAK,EAAE;;;AAInB,MAAM,KAAK,YAAY,QAAQ;AAE/B,IAAI,CAAC,UAAU;AACb,SAAQ,MAAM,yCAAyC;AACvD,SAAQ,KAAK,EAAE;;AAGjB,UAAU,SAAS,CAAC,OAAO,QAAQ;AACjC,SAAQ,MAAM,UAAU,IAAI;AAC5B,SAAQ,KAAK,EAAE;EACf"}