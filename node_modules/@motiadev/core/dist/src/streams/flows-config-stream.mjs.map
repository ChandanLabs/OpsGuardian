{"version":3,"file":"flows-config-stream.mjs","names":["configPath: string"],"sources":["../../../src/streams/flows-config-stream.ts"],"sourcesContent":["import fs from 'fs'\nimport { StreamAdapter } from '../adapters/interfaces/stream-adapter.interface'\nimport type { FlowConfig } from '../types/flows-config-types'\n\nexport class FlowsConfigStream extends StreamAdapter<FlowConfig> {\n  private config: FlowConfig[] = []\n\n  constructor(private readonly configPath: string) {\n    super('__motia.flows-config')\n  }\n\n  private getConfig(): FlowConfig[] {\n    if (this.config.length === 0) {\n      if (fs.existsSync(this.configPath)) {\n        this.config = JSON.parse(fs.readFileSync(this.configPath, 'utf8') || '[]')\n        if (!Array.isArray(this.config)) {\n          this.config = []\n          this.setConfig(this.config)\n        }\n      }\n    }\n    return this.config\n  }\n\n  private setConfig(config: FlowConfig[]) {\n    this.config = config\n    fs.writeFileSync(this.configPath, JSON.stringify(config, null, 2), 'utf8')\n  }\n\n  async get(_: string, id: string) {\n    const allFlowsConfig = this.getConfig()\n    return allFlowsConfig.find((flow) => flow.id === id) || null\n  }\n\n  async delete(_: string): Promise<null> {\n    return null\n  }\n\n  async set(_: string, id: string, data: FlowConfig): Promise<FlowConfig> {\n    const existingConfig = this.getConfig()\n\n    const updatedConfig = existingConfig.filter((item) => item.id !== id)\n    updatedConfig.push(data)\n\n    this.setConfig(updatedConfig)\n    return data\n  }\n\n  async getGroup(): Promise<FlowConfig[]> {\n    return this.getConfig()\n  }\n}\n"],"mappings":";;;;AAIA,IAAa,oBAAb,cAAuC,cAA0B;CAG/D,YAAY,AAAiBA,YAAoB;AAC/C,QAAM,uBAAuB;EADF;gBAFE,EAAE;;CAMjC,AAAQ,YAA0B;AAChC,MAAI,KAAK,OAAO,WAAW,GACzB;OAAI,GAAG,WAAW,KAAK,WAAW,EAAE;AAClC,SAAK,SAAS,KAAK,MAAM,GAAG,aAAa,KAAK,YAAY,OAAO,IAAI,KAAK;AAC1E,QAAI,CAAC,MAAM,QAAQ,KAAK,OAAO,EAAE;AAC/B,UAAK,SAAS,EAAE;AAChB,UAAK,UAAU,KAAK,OAAO;;;;AAIjC,SAAO,KAAK;;CAGd,AAAQ,UAAU,QAAsB;AACtC,OAAK,SAAS;AACd,KAAG,cAAc,KAAK,YAAY,KAAK,UAAU,QAAQ,MAAM,EAAE,EAAE,OAAO;;CAG5E,MAAM,IAAI,GAAW,IAAY;AAE/B,SADuB,KAAK,WAAW,CACjB,MAAM,SAAS,KAAK,OAAO,GAAG,IAAI;;CAG1D,MAAM,OAAO,GAA0B;AACrC,SAAO;;CAGT,MAAM,IAAI,GAAW,IAAY,MAAuC;EAGtE,MAAM,gBAFiB,KAAK,WAAW,CAEF,QAAQ,SAAS,KAAK,OAAO,GAAG;AACrE,gBAAc,KAAK,KAAK;AAExB,OAAK,UAAU,cAAc;AAC7B,SAAO;;CAGT,MAAM,WAAkC;AACtC,SAAO,KAAK,WAAW"}