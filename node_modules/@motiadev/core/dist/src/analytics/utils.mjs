import os from "os";
import crypto from "crypto";
import fs from "fs";
import path from "path";
import { track } from "@amplitude/analytics-node";

//#region src/analytics/utils.ts
const getProjectName = (baseDir) => {
	const packageJsonPath = path.join(baseDir, "package.json");
	if (fs.existsSync(packageJsonPath)) return JSON.parse(fs.readFileSync(packageJsonPath, "utf8")).name || path.basename(baseDir);
	return "unknown";
};
const getUserIdentifier = () => {
	const userInfo = `${os.userInfo().username}${os.hostname()}`;
	return crypto.createHash("sha256").update(userInfo).digest("hex").substring(0, 16);
};
const getProjectIdentifier = (baseDir) => {
	try {
		return crypto.createHash("sha256").update(getProjectName(baseDir)).digest("hex").substring(0, 16);
	} catch (error) {
		return "unknown";
	}
};
const isAnalyticsEnabled = () => {
	return process.env.MOTIA_ANALYTICS_DISABLED !== "true";
};
const trackEvent = (eventName, properties = {}) => {
	try {
		if (isAnalyticsEnabled()) track(eventName, properties, { user_id: getUserIdentifier() || "unknown" });
	} catch (error) {}
};

//#endregion
export { getProjectIdentifier, getProjectName, getUserIdentifier, isAnalyticsEnabled, trackEvent };
//# sourceMappingURL=utils.mjs.map