{"version":3,"file":"plugin.js","names":["ApiRequest","ApiResponse","FlowContext","MotiaPluginContext","api","motia","registerApi","method","path","req","Promise","groupId","queryParams","filter","JSON","parse","undefined","items","state","status","body","Record","error","Error","message","ctx","key","value","set","id","ids","keyParts","split","join","delete","MotiaPlugin","MotiaPluginContext","api","plugin","motia","workbench","packageName","cssImports","label","position","componentName","labelIcon"],"sources":["../src/api.ts","../src/plugin.ts"],"sourcesContent":["import type { ApiRequest, ApiResponse, FlowContext, MotiaPluginContext } from '@motiadev/core'\n\nexport const api = (motia: MotiaPluginContext): void => {\n  motia.registerApi(\n    {\n      method: 'GET',\n      path: '/__motia/state',\n    },\n    async (req: ApiRequest): Promise<ApiResponse> => {\n      try {\n        const groupId = req.queryParams.groupId as string | undefined\n        const filter = req.queryParams.filter ? JSON.parse(req.queryParams.filter as string) : undefined\n        const items = await motia.state.items({ groupId, filter })\n\n        return {\n          status: 200,\n          body: items as unknown as Record<string, unknown>,\n        }\n      } catch (error: unknown) {\n        return {\n          status: 500,\n          body: { error: error instanceof Error ? error.message : 'Unknown error' },\n        }\n      }\n    },\n  )\n\n  motia.registerApi(\n    {\n      method: 'POST',\n      path: '/__motia/state',\n    },\n    async (req: ApiRequest, ctx: FlowContext): Promise<ApiResponse> => {\n      try {\n        const { key, groupId, value } = req.body as { key: string; groupId: string; value: any }\n        await ctx.state.set(groupId, key, value)\n        return {\n          status: 200,\n          body: { key, groupId, value },\n        }\n      } catch (error: unknown) {\n        return {\n          status: 500,\n          body: { error: error instanceof Error ? error.message : 'Unknown error' },\n        }\n      }\n    },\n  )\n\n  motia.registerApi(\n    {\n      method: 'POST',\n      path: '/__motia/state/delete',\n    },\n    async (req: ApiRequest, ctx: FlowContext): Promise<ApiResponse> => {\n      try {\n        for (const id of (req.body as { ids: string[] }).ids) {\n          const [groupId, ...keyParts] = id.split(':')\n          const key = keyParts.join(':')\n          await ctx.state.delete(groupId, key)\n        }\n\n        return {\n          status: 204,\n          body: '',\n        }\n      } catch (error: unknown) {\n        return {\n          status: 500,\n          body: { error: error instanceof Error ? error.message : 'Unknown error' },\n        }\n      }\n    },\n  )\n}\n","import type { MotiaPlugin, MotiaPluginContext } from '@motiadev/core'\nimport { api } from './api'\n\nexport default function plugin(motia: MotiaPluginContext): MotiaPlugin {\n  api(motia)\n\n  return {\n    workbench: [\n      {\n        packageName: '@motiadev/plugin-states',\n        cssImports: ['@motiadev/plugin-states/dist/styles.css'],\n        label: 'States',\n        position: 'bottom',\n        componentName: 'StatesPage',\n        labelIcon: 'file',\n      },\n    ],\n  }\n}\n"],"mappings":";AAEA,MAAaI,OAAOC,UAAoC;AACtDA,OAAMC,YACJ;EACEC,QAAQ;EACRC,MAAM;EACP,EACD,OAAOC,QAA0C;AAC/C,MAAI;GACF,MAAME,UAAUF,IAAIG,YAAYD;GAChC,MAAME,SAASJ,IAAIG,YAAYC,SAASC,KAAKC,MAAMN,IAAIG,YAAYC,OAAiB,GAAGG;AAGvF,UAAO;IACLG,QAAQ;IACRC,MAJY,MAAMf,MAAMa,MAAMD,MAAM;KAAEN;KAASE;KAAQ,CAAC;IAKzD;WACMS,OAAgB;AACvB,UAAO;IACLH,QAAQ;IACRC,MAAM,EAAEE,OAAOA,iBAAiBC,QAAQD,MAAME,UAAU,iBAAgB;IACzE;;GAGN;AAEDnB,OAAMC,YACJ;EACEC,QAAQ;EACRC,MAAM;EACP,EACD,OAAOC,KAAiBgB,QAA2C;AACjE,MAAI;GACF,MAAM,EAAEC,KAAKf,SAASgB,UAAUlB,IAAIW;AACpC,SAAMK,IAAIP,MAAMU,IAAIjB,SAASe,KAAKC,MAAM;AACxC,UAAO;IACLR,QAAQ;IACRC,MAAM;KAAEM;KAAKf;KAASgB;KAAM;IAC7B;WACML,OAAgB;AACvB,UAAO;IACLH,QAAQ;IACRC,MAAM,EAAEE,OAAOA,iBAAiBC,QAAQD,MAAME,UAAU,iBAAgB;IACzE;;GAGN;AAEDnB,OAAMC,YACJ;EACEC,QAAQ;EACRC,MAAM;EACP,EACD,OAAOC,KAAiBgB,QAA2C;AACjE,MAAI;AACF,QAAK,MAAMI,MAAOpB,IAAIW,KAA2BU,KAAK;IACpD,MAAM,CAACnB,SAAS,GAAGoB,YAAYF,GAAGG,MAAM,IAAI;IAC5C,MAAMN,MAAMK,SAASE,KAAK,IAAI;AAC9B,UAAMR,IAAIP,MAAMgB,OAAOvB,SAASe,IAAI;;AAGtC,UAAO;IACLP,QAAQ;IACRC,MAAM;IACP;WACME,OAAgB;AACvB,UAAO;IACLH,QAAQ;IACRC,MAAM,EAAEE,OAAOA,iBAAiBC,QAAQD,MAAME,UAAU,iBAAgB;IACzE;;GAGN;;;;;ACtEH,SAAwBc,OAAOC,OAAwC;AACrEF,KAAIE,MAAM;AAEV,QAAO,EACLC,WAAW,CACT;EACEC,aAAa;EACbC,YAAY,CAAC,0CAA0C;EACvDC,OAAO;EACPC,UAAU;EACVC,eAAe;EACfC,WAAW;EACZ,CAAA,EAEJ"}