{
  "version": 3,
  "sources": ["../../../../stream-client-react/src/motia-stream-context.ts", "../../../../stream-client-react/src/motia-stream-provider.tsx", "../../../../stream-client-react/src/use-motia-stream.ts", "../../../../stream-client-react/src/use-stream-event-handler.ts", "../../../../stream-client-react/src/use-stream-group.ts", "../../../../stream-client-react/src/use-stream-item.ts"],
  "sourcesContent": ["import type { Stream } from '@motiadev/stream-client-browser'\nimport React from 'react'\n\ntype MotiaStreamContextType = {\n  stream: Stream | null\n}\n\nexport const MotiaStreamContext = React.createContext<MotiaStreamContextType>({\n  stream: null,\n})\n", "import { Stream } from '@motiadev/stream-client-browser'\nimport { useEffect, useMemo, useState } from 'react'\nimport { MotiaStreamContext } from './motia-stream-context'\n\ntype Props = React.PropsWithChildren<{\n  /**\n   * The address of the stream server.\n   *\n   * @example\n   * ```tsx\n   * <MotiaStreamProvider address=\"ws://localhost:3000\">\n   *   <App />\n   * </MotiaStreamProvider>\n   * */\n  address: string\n  protocols?: string | string[] | undefined\n}>\n\nexport const MotiaStreamProvider: React.FC<Props> = ({ children, address, protocols }) => {\n  const [stream, setStream] = useState<Stream | null>(null)\n\n  useEffect(() => {\n    const streamInstance = new Stream(address, { protocols })\n    setStream(streamInstance)\n    return () => streamInstance.close()\n  }, [address, protocols])\n\n  const contextValue = useMemo(() => ({ stream }), [stream])\n\n  return <MotiaStreamContext.Provider value={contextValue}>{children}</MotiaStreamContext.Provider>\n}\n", "import React from 'react'\nimport { MotiaStreamContext } from './motia-stream-context'\n\n/**\n * A hook to get the stream context.\n *\n * @example\n * ```tsx\n * const { stream } = useMotiaStream()\n * ```\n */\nexport const useMotiaStream = () => {\n  const context = React.useContext(MotiaStreamContext)\n\n  if (!context) {\n    throw new Error('useMotiaStream must be used within a MotiaStreamProvider')\n  }\n\n  return context\n}\n", "import type { StreamSubscription } from '@motiadev/stream-client-browser'\nimport { type DependencyList, useEffect } from 'react'\n\ntype UseStreamEventHandler = {\n  event: StreamSubscription | null\n  type: string\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  listener: (event: any) => void\n}\n\n/**\n * A hook to handle custom stream events.\n *\n * @example\n * ```tsx\n * const { event } = useStreamItem({ streamName: 'my-stream', id: '123' })\n *\n * const onEventHandled = (event: any) => {\n *   // this is going to be called whenever 'on-custom-event' is sent from the server\n *   console.log(event)\n * }\n *\n * useStreamEventHandler({ event, type: 'on-custom-event', listener: onEventHandled }, [])\n * ```\n */\nexport const useStreamEventHandler = (\n  { event, type, listener }: UseStreamEventHandler,\n  dependencies: DependencyList,\n) => {\n  useEffect(() => {\n    if (event) {\n      event.onEvent(type, listener)\n      return () => event.offEvent(type, listener)\n    }\n  }, [event, type, ...dependencies])\n}\n", "import type { StreamSubscription } from '@motiadev/stream-client-browser'\nimport { useEffect, useRef, useState } from 'react'\nimport { useMotiaStream } from './use-motia-stream'\n\nexport type StreamGroupArgs<TData extends { id: string }> = {\n  streamName: string\n  groupId: string\n  sortKey?: keyof TData\n  setData?: (data: TData[]) => void\n}\n\n/**\n * A hook to get a group of items from a stream.\n *\n * @example\n * ```tsx\n * const { data } = useStreamGroup<{ id:string; name: string }>({\n *   streamName: 'my-stream',\n *   groupId: '123',\n * })\n *\n * return (\n *   <div>\n *     {data.map((item) => (\n *       <div key={item.id}>{item.name}</div>\n *     ))}\n *   </div>\n * )\n * ```\n */\nexport const useStreamGroup = <TData extends { id: string }>(args?: StreamGroupArgs<TData>) => {\n  const { stream } = useMotiaStream()\n  const [data, setData] = useState<TData[]>([])\n  const subscriptionRef = useRef<StreamSubscription | null>(null)\n\n  const { streamName, groupId, sortKey, setData: setDataCallback } = args || {}\n\n  useEffect(() => {\n    if (!streamName || !groupId || !stream) {\n      console.error('useStreamGroup: streamName, groupId or stream is not defined', { streamName, groupId, stream })\n      return\n    }\n\n    subscriptionRef.current = stream.subscribeGroup(streamName, groupId, sortKey)\n\n    subscriptionRef.current.addChangeListener((data) => {\n      const typedData = data as TData[]\n      setData(typedData)\n      setDataCallback?.(typedData)\n    })\n\n    return () => {\n      subscriptionRef.current?.close()\n      subscriptionRef.current = null\n      setData([])\n    }\n  }, [stream, streamName, groupId, sortKey, setDataCallback])\n\n  return { data, event: subscriptionRef.current }\n}\n", "import type { StreamSubscription } from '@motiadev/stream-client-browser'\nimport { useCallback, useEffect, useState } from 'react'\nimport { useMotiaStream } from './use-motia-stream'\n\nexport type StreamItemArgs = {\n  streamName: string\n  groupId: string\n  id?: string\n}\n\n/**\n * A hook to get a single item from a stream.\n *\n * @example\n * ```tsx\n * const { data } = useStreamItem<{ id:string; name: string }>({\n *   streamName: 'my-stream',\n *   groupId: '123',\n *   id: '123',\n * })\n *\n * return (\n *   <div>{data?.name}</div>\n * )\n * ```\n */\nexport const useStreamItem = <TData>(args?: StreamItemArgs) => {\n  const { stream } = useMotiaStream()\n  const [data, setData] = useState<TData | null | undefined>()\n  const [event, setEvent] = useState<StreamSubscription | null>(null)\n  const { streamName, groupId, id } = args || {}\n\n  const handleChange = useCallback((data: unknown) => {\n    setData(data as TData)\n  }, [])\n\n  useEffect(() => {\n    if (!streamName || !groupId || !id || !stream) return\n\n    const subscription = stream.subscribeItem(streamName, groupId, id)\n\n    subscription.addChangeListener(handleChange)\n    setEvent(subscription)\n\n    return () => {\n      setData(undefined)\n      setEvent(null)\n      subscription.close()\n    }\n  }, [stream, streamName, groupId, id, handleChange])\n\n  return { data, event }\n}\n"],
  "mappings": "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",
  "names": ["MotiaStreamContext", "React", "createContext", "stream", "MotiaStreamProvider", "t0", "$", "_c", "children", "address", "protocols", "setStream", "useState", "t1", "t2", "streamInstance", "Stream", "close", "useEffect", "t3", "contextValue", "t4", "useMotiaStream", "context", "useContext", "Error", "useStreamEventHandler", "dependencies", "event", "type", "listener", "onEvent", "offEvent", "useStreamGroup", "args", "data", "setData", "subscriptionRef", "useRef", "streamName", "groupId", "sortKey", "setDataCallback", "console", "error", "current", "subscribeGroup", "addChangeListener", "typedData", "useStreamItem", "setEvent", "id", "Symbol", "for", "data_0", "handleChange", "subscription", "subscribeItem", "undefined"]
}
