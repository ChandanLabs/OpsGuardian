{
  "version": 3,
  "sources": ["../../../../plugin-logs/src/stores/use-logs-store.ts", "../../../../plugin-logs/src/hooks/use-logs-stream.ts", "../../../../plugin-logs/src/utils/format-timestamp.ts", "../../../../plugin-logs/src/components/log-detail.tsx", "../../../../plugin-logs/src/components/logs-page.tsx"],
  "sourcesContent": ["import { create } from 'zustand'\nimport type { Log } from '../types/log'\n\nexport type LogsState = {\n  logs: Log[]\n  selectedLogId?: string\n  setLogs: (logs: Log[]) => void\n  resetLogs: () => void\n  selectLogId: (logId?: string) => void\n}\n\nexport const useLogsStore = create<LogsState>()((set) => ({\n  logs: [],\n  selectedLogId: undefined,\n  setLogs: (logs: Log[]) =>\n    set(() => {\n      const safeLogs = Array.isArray(logs) ? logs : []\n      return {\n        logs: [...safeLogs].reverse(),\n      }\n    }),\n  resetLogs: () => {\n    set({ logs: [] })\n  },\n  selectLogId: (logId) => set({ selectedLogId: logId }),\n}))\n", "import { useStreamGroup } from '@motiadev/stream-client-react'\nimport { useLogsStore } from '../stores/use-logs-store'\nimport type { Log } from '../types/log'\n\nconst streamName = '__motia.logs'\nconst groupId = 'default'\n\nexport const useLogsStream = () => {\n  const setData = useLogsStore((state) => state.setLogs)\n\n  useStreamGroup<Log>({\n    streamName,\n    groupId,\n    setData,\n  })\n}\n", "export const formatTimestamp = (time: number) => {\n  const date = new Date(Number(time))\n  return `${date.toLocaleDateString('en-US', { year: undefined, month: 'short', day: '2-digit' })}, ${date.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', second: '2-digit', hourCycle: 'h24' })}.${date.getMilliseconds().toString().padStart(3, '0')}`\n}\n", "import { LevelDot, Sidebar } from '@motiadev/ui'\nimport { X } from 'lucide-react'\nimport type React from 'react'\nimport { useMemo, useState } from 'react'\nimport ReactJson from 'react18-json-view'\nimport 'react18-json-view/src/dark.css'\nimport 'react18-json-view/src/style.css'\nimport type { Log } from '../types/log'\nimport { formatTimestamp } from '../utils/format-timestamp'\n\ntype Props = {\n  log?: Log\n  onClose: () => void\n}\n\nconst defaultProps = ['id', 'msg', 'time', 'level', 'step', 'flows', 'traceId']\n\nexport const LogDetail: React.FC<Props> = ({ log, onClose }) => {\n  const [hasOtherProps, setHasOtherProps] = useState(false)\n\n  const otherPropsObject = useMemo(() => {\n    if (!log) {\n      return null\n    }\n\n    const otherProps = Object.keys(log ?? {}).filter((key) => !defaultProps.includes(key))\n    setHasOtherProps(otherProps.length > 0)\n\n    return otherProps.reduce(\n      (acc, key) => {\n        acc[key] = log[key]\n        return acc\n      },\n      {} as Record<string, unknown>,\n    )\n  }, [log])\n\n  if (!log) {\n    return null\n  }\n\n  return (\n    <Sidebar\n      onClose={onClose}\n      title=\"Logs Details\"\n      subtitle=\"Details including custom properties\"\n      actions={[{ icon: <X />, onClick: onClose, label: 'Close' }]}\n      details={[\n        {\n          label: 'Level',\n          value: (\n            <div className=\"flex items-center gap-2\">\n              <LevelDot level={log.level} />\n              <div className=\"capitalize\">{log.level}</div>\n            </div>\n          ),\n        },\n        { label: 'Time', value: formatTimestamp(log.time) },\n        { label: 'Step', value: log.step },\n        { label: 'Flows', value: log.flows.join(', ') },\n        { label: 'Trace ID', value: log.traceId },\n      ]}\n    >\n      {hasOtherProps && <ReactJson src={otherPropsObject} theme=\"default\" enableClipboard />}\n    </Sidebar>\n  )\n}\n", "import { Button, cn, Input, LevelDot } from '@motiadev/ui'\nimport { useVirtualizer } from '@tanstack/react-virtual'\nimport { Filter, Search, Trash, X } from 'lucide-react'\nimport { useMemo, useRef, useState } from 'react'\nimport { useLogsStream } from '../hooks/use-logs-stream'\nimport { useLogsStore } from '../stores/use-logs-store'\nimport { formatTimestamp } from '../utils/format-timestamp'\nimport { LogDetail } from './log-detail'\n\nconst ROW_HEIGHT = 40\n\nexport const LogsPage = () => {\n  useLogsStream()\n\n  const logs = useLogsStore((state) => state.logs)\n  const resetLogs = useLogsStore((state) => state.resetLogs)\n  const selectedLogId = useLogsStore((state) => state.selectedLogId)\n  const selectLogId = useLogsStore((state) => state.selectLogId)\n  const selectedLog = useMemo(\n    () => (selectedLogId ? logs.find((log) => log.id === selectedLogId) : undefined),\n    [logs, selectedLogId],\n  )\n\n  const [search, setSearch] = useState('')\n  const filteredLogs = useMemo(() => {\n    return logs.filter((log) => {\n      return (\n        String(log.msg || '')\n          .toLowerCase()\n          .includes(search.toLowerCase()) ||\n        String(log.traceId || '')\n          .toLowerCase()\n          .includes(search.toLowerCase()) ||\n        String(log.step || '')\n          .toLowerCase()\n          .includes(search.toLowerCase())\n      )\n    })\n  }, [logs, search])\n\n  const scrollContainerRef = useRef<HTMLDivElement>(null)\n\n  const virtualizer = useVirtualizer({\n    count: filteredLogs.length,\n    getScrollElement: () => scrollContainerRef.current,\n    estimateSize: () => ROW_HEIGHT,\n    overscan: 5,\n  })\n\n  const virtualItems = virtualizer.getVirtualItems()\n\n  return (\n    <>\n      <div className=\"grid grid-rows-[auto_1fr] h-full\" data-testid=\"logs-container\">\n        <div className=\"flex p-2 border-b gap-2\" data-testid=\"logs-search-container\">\n          <div className=\"flex-1 relative\">\n            <Input\n              variant=\"shade\"\n              value={search}\n              onChange={(e) => setSearch(e.target.value)}\n              className=\"px-9! font-medium\"\n              placeholder=\"Search by Trace ID or Message\"\n            />\n            <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/50\" />\n            <X\n              className=\"cursor-pointer absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground/50 hover:text-muted-foreground\"\n              onClick={() => setSearch('')}\n            />\n          </div>\n          <Button variant=\"default\" onClick={resetLogs} className=\"h-[34px]\">\n            <Trash /> Clear\n          </Button>\n        </div>\n        <div ref={scrollContainerRef} className=\"overflow-auto h-full\">\n          <div className=\"relative w-full\" style={{ height: virtualizer.getTotalSize() }}>\n            {virtualItems.map((virtualRow) => {\n              const log = filteredLogs[virtualRow.index]\n              if (!log) return null\n              const index = virtualRow.index\n              return (\n                <div\n                  data-testid=\"log-row\"\n                  data-index={virtualRow.index}\n                  ref={virtualizer.measureElement}\n                  key={log.id}\n                  role=\"row\"\n                  tabIndex={0}\n                  className={cn(\n                    'absolute left-0 w-full flex items-center font-mono font-semibold cursor-pointer text-sm',\n                    {\n                      'bg-muted-foreground/10 hover:bg-muted-foreground/20': selectedLogId === log.id,\n                      'hover:bg-muted-foreground/10': selectedLogId !== log.id,\n                    },\n                  )}\n                  style={{\n                    height: ROW_HEIGHT,\n                    transform: `translateY(${virtualRow.start}px)`,\n                  }}\n                  onClick={() => selectLogId(log.id)}\n                  onKeyDown={(e) => {\n                    if (e.key === 'Enter' || e.key === ' ') {\n                      selectLogId(log.id)\n                    }\n                  }}\n                >\n                  <div\n                    data-testid={`time-${index}`}\n                    role=\"cell\"\n                    className=\"whitespace-nowrap flex items-center gap-2 text-muted-foreground p-2 shrink-0\"\n                  >\n                    <LevelDot level={log.level} />\n                    {formatTimestamp(log.time)}\n                  </div>\n                  <div className=\"flex items-center shrink-0\">\n                    <span\n                      data-testid={`trace-${log.traceId}`}\n                      className=\"whitespace-nowrap text-muted-foreground p-2 font-mono font-semibold text-sm\"\n                    >\n                      {log.traceId}\n                    </span>\n                    <button\n                      type=\"button\"\n                      data-testid={`trace-filter-${log.traceId}`}\n                      aria-label={`Filter by trace ${log.traceId}`}\n                      title={`Filter by trace ${log.traceId}`}\n                      className=\"p-1 rounded hover:bg-muted-foreground/20 text-muted-foreground hover:text-primary transition-colors cursor-pointer\"\n                      onClick={(e) => {\n                        e.stopPropagation()\n                        setSearch(log.traceId)\n                      }}\n                    >\n                      <Filter className=\"w-3 h-3\" />\n                    </button>\n                  </div>\n                  <div\n                    data-testid={`step-${index}`}\n                    role=\"cell\"\n                    title={log.step}\n                    className=\"whitespace-nowrap p-2 shrink-0\"\n                  >\n                    {log.step}\n                  </div>\n                  <div\n                    data-testid={`msg-${index}`}\n                    role=\"cell\"\n                    title={log.msg}\n                    className=\"whitespace-nowrap max-w-[500px] truncate p-2 flex-1\"\n                  >\n                    {log.msg}\n                  </div>\n                </div>\n              )\n            })}\n          </div>\n        </div>\n      </div>\n      <LogDetail log={selectedLog} onClose={() => selectLogId(undefined)} />\n    </>\n  )\n}\n"],
  "mappings": "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",
  "names": ["useLogsStore", "create", "set", "logs", "selectedLogId", "undefined", "setLogs", "Array", "isArray", "reverse", "resetLogs", "selectLogId", "logId", "streamName", "groupId", "useLogsStream", "$", "_c", "$i", "Symbol", "for", "setData", "_temp", "t0", "useStreamGroup", "state", "formatTimestamp", "time", "date", "Date", "Number", "toLocaleDateString", "year", "month", "day", "toLocaleTimeString", "hour", "minute", "second", "hourCycle", "getMilliseconds", "toString", "padStart", "defaultProps", "LogDetail", "log", "onClose", "hasOtherProps", "setHasOtherProps", "useState", "otherPropsObject", "useMemo", "otherProps", "Object", "keys", "filter", "key", "includes", "length", "reduce", "acc", "icon", "onClick", "label", "value", "level", "step", "flows", "join", "traceId", "ROW_HEIGHT", "LogsPage", "selectedLog", "find", "id", "search", "setSearch", "filteredLogs", "String", "msg", "toLowerCase", "scrollContainerRef", "useRef", "virtualizer", "useVirtualizer", "count", "getScrollElement", "current", "estimateSize", "overscan", "virtualItems", "getVirtualItems", "e", "target", "height", "getTotalSize", "map", "virtualRow", "index", "measureElement", "cn", "transform", "start", "stopPropagation"]
}
