import IORedis from "ioredis";

//#region src/connection-manager.ts
var ConnectionManager = class {
	constructor(config) {
		if (config instanceof IORedis) {
			this.connection = config;
			this.ownsConnection = false;
		} else {
			this.connection = new IORedis({
				maxRetriesPerRequest: null,
				...config
			});
			this.ownsConnection = true;
		}
		this.isClosed = false;
		this.setupEventHandlers();
	}
	setupEventHandlers() {
		this.connection.on("error", (err) => {
			if (!this.isClosed) console.warn("[BullMQ] Connection error:", err?.message);
		});
		this.connection.on("close", () => {
			this.isClosed = true;
			console.warn("[BullMQ] Connection closed");
		});
	}
	async close() {
		if (this.ownsConnection && this.connection.status !== "end") await this.connection.quit();
	}
};

//#endregion
export { ConnectionManager };
//# sourceMappingURL=connection-manager.mjs.map