let CURRENT_STATE = {
  healthy: true,
  activeIncidents: [],
  cpuUsage: 12
};
class InfrastructureManager {
  /**
   * Simulates a system crash initiated by chaos engineering or random failure.
   */
  static async simulateChaos() {
    console.log("\u{1F525} CHAOS MONKEY: Injecting failure into Redis Connection Pool...");
    CURRENT_STATE.healthy = false;
    CURRENT_STATE.activeIncidents.push("REDIS_CONNECTION_TIMEOUT");
    CURRENT_STATE.cpuUsage = 98;
  }
  /**
   * Fetches the last 50 lines of logs.
   * If the system is broken, it injects error logs.
   */
  static async getSystemLogs() {
    const timestamp = (/* @__PURE__ */ new Date()).toISOString();
    if (CURRENT_STATE.healthy) {
      return `
[${timestamp}] INFO: Server listening on port 3000
[${timestamp}] INFO: Database connection active
[${timestamp}] INFO: Job queue processing normally
      `.trim();
    } else {
      return `
[${timestamp}] ERROR: Connection to Redis timed out after 5000ms
[${timestamp}] FATAL: RedisPoolExhaustedError: No available clients
[${timestamp}] WARN: Retrying connection... failed.
[${timestamp}] ERROR: Critical process failure in PID 8923
      `.trim();
    }
  }
  /**
   * Checks the health of the system via HTTP ping simulation.
   */
  static async healthCheck() {
    if (CURRENT_STATE.healthy) {
      return { status: 200, message: "OK" };
    } else {
      return { status: 500, message: "SERVICE_UNAVAILABLE" };
    }
  }
  /**
   * Executes a shell command on the server.
   * @param command The bash command to run
   */
  static async executeCommand(command) {
    console.log(`\u{1F4BB} Executing Command on Remote Host: $ ${command}`);
    await new Promise((resolve) => setTimeout(resolve, 2e3));
    if (command.includes("restart redis") || command.includes("flushall")) {
      CURRENT_STATE.healthy = true;
      CURRENT_STATE.activeIncidents = [];
      CURRENT_STATE.cpuUsage = 15;
      return "Command executed successfully. Service 'redis-server' restarted. stdout: OK";
    }
    return `Command '${command}' executed. No specific state change detected.`;
  }
}
export {
  InfrastructureManager
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vLi4vc3JjL3NlcnZpY2VzL21vY2tfaW5mcmFzdHJ1Y3R1cmUudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbIlxyXG4vKipcclxuICogU2VydmljZTogSW5mcmFzdHJ1Y3R1cmUgTWFuYWdlclxyXG4gKiBSb2xlOiBTaW11bGF0ZXMgYSByZWFsIG1vbml0b3Jpbmcgc3lzdGVtIChEYXRhZG9nL1Byb21ldGhldXMpIGFuZCBhbiBleGVjdXRpb24gc2hlbGwgKFNTSCkuXHJcbiAqL1xyXG5cclxuaW50ZXJmYWNlIFN5c3RlbVN0YXRlIHtcclxuICAgIGhlYWx0aHk6IGJvb2xlYW47XHJcbiAgICBhY3RpdmVJbmNpZGVudHM6IHN0cmluZ1tdO1xyXG4gICAgY3B1VXNhZ2U6IG51bWJlcjtcclxufVxyXG5cclxuLy8gR2xvYmFsIG11dGFibGUgc3RhdGUgZm9yIHNpbXVsYXRpb25cclxubGV0IENVUlJFTlRfU1RBVEU6IFN5c3RlbVN0YXRlID0ge1xyXG4gICAgaGVhbHRoeTogdHJ1ZSxcclxuICAgIGFjdGl2ZUluY2lkZW50czogW10sXHJcbiAgICBjcHVVc2FnZTogMTJcclxufTtcclxuXHJcbmV4cG9ydCBjbGFzcyBJbmZyYXN0cnVjdHVyZU1hbmFnZXIge1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogU2ltdWxhdGVzIGEgc3lzdGVtIGNyYXNoIGluaXRpYXRlZCBieSBjaGFvcyBlbmdpbmVlcmluZyBvciByYW5kb20gZmFpbHVyZS5cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGFzeW5jIHNpbXVsYXRlQ2hhb3MoKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICAgICAgY29uc29sZS5sb2coXCJcdUQ4M0RcdUREMjUgQ0hBT1MgTU9OS0VZOiBJbmplY3RpbmcgZmFpbHVyZSBpbnRvIFJlZGlzIENvbm5lY3Rpb24gUG9vbC4uLlwiKTtcclxuICAgICAgICBDVVJSRU5UX1NUQVRFLmhlYWx0aHkgPSBmYWxzZTtcclxuICAgICAgICBDVVJSRU5UX1NUQVRFLmFjdGl2ZUluY2lkZW50cy5wdXNoKFwiUkVESVNfQ09OTkVDVElPTl9USU1FT1VUXCIpO1xyXG4gICAgICAgIENVUlJFTlRfU1RBVEUuY3B1VXNhZ2UgPSA5ODtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIEZldGNoZXMgdGhlIGxhc3QgNTAgbGluZXMgb2YgbG9ncy5cclxuICAgICAqIElmIHRoZSBzeXN0ZW0gaXMgYnJva2VuLCBpdCBpbmplY3RzIGVycm9yIGxvZ3MuXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBhc3luYyBnZXRTeXN0ZW1Mb2dzKCk6IFByb21pc2U8c3RyaW5nPiB7XHJcbiAgICAgICAgY29uc3QgdGltZXN0YW1wID0gbmV3IERhdGUoKS50b0lTT1N0cmluZygpO1xyXG5cclxuICAgICAgICBpZiAoQ1VSUkVOVF9TVEFURS5oZWFsdGh5KSB7XHJcbiAgICAgICAgICAgIHJldHVybiBgXHJcblske3RpbWVzdGFtcH1dIElORk86IFNlcnZlciBsaXN0ZW5pbmcgb24gcG9ydCAzMDAwXHJcblske3RpbWVzdGFtcH1dIElORk86IERhdGFiYXNlIGNvbm5lY3Rpb24gYWN0aXZlXHJcblske3RpbWVzdGFtcH1dIElORk86IEpvYiBxdWV1ZSBwcm9jZXNzaW5nIG5vcm1hbGx5XHJcbiAgICAgIGAudHJpbSgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBgXHJcblske3RpbWVzdGFtcH1dIEVSUk9SOiBDb25uZWN0aW9uIHRvIFJlZGlzIHRpbWVkIG91dCBhZnRlciA1MDAwbXNcclxuWyR7dGltZXN0YW1wfV0gRkFUQUw6IFJlZGlzUG9vbEV4aGF1c3RlZEVycm9yOiBObyBhdmFpbGFibGUgY2xpZW50c1xyXG5bJHt0aW1lc3RhbXB9XSBXQVJOOiBSZXRyeWluZyBjb25uZWN0aW9uLi4uIGZhaWxlZC5cclxuWyR7dGltZXN0YW1wfV0gRVJST1I6IENyaXRpY2FsIHByb2Nlc3MgZmFpbHVyZSBpbiBQSUQgODkyM1xyXG4gICAgICBgLnRyaW0oKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGVja3MgdGhlIGhlYWx0aCBvZiB0aGUgc3lzdGVtIHZpYSBIVFRQIHBpbmcgc2ltdWxhdGlvbi5cclxuICAgICAqL1xyXG4gICAgc3RhdGljIGFzeW5jIGhlYWx0aENoZWNrKCk6IFByb21pc2U8eyBzdGF0dXM6IG51bWJlcjsgbWVzc2FnZTogc3RyaW5nIH0+IHtcclxuICAgICAgICBpZiAoQ1VSUkVOVF9TVEFURS5oZWFsdGh5KSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHN0YXR1czogMjAwLCBtZXNzYWdlOiBcIk9LXCIgfTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXR1cm4geyBzdGF0dXM6IDUwMCwgbWVzc2FnZTogXCJTRVJWSUNFX1VOQVZBSUxBQkxFXCIgfTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBFeGVjdXRlcyBhIHNoZWxsIGNvbW1hbmQgb24gdGhlIHNlcnZlci5cclxuICAgICAqIEBwYXJhbSBjb21tYW5kIFRoZSBiYXNoIGNvbW1hbmQgdG8gcnVuXHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBhc3luYyBleGVjdXRlQ29tbWFuZChjb21tYW5kOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBcdUQ4M0RcdURDQkIgRXhlY3V0aW5nIENvbW1hbmQgb24gUmVtb3RlIEhvc3Q6ICQgJHtjb21tYW5kfWApO1xyXG5cclxuICAgICAgICAvLyBTaW11bGF0ZSBsYXRlbmN5IG9mIGEgcmVzdGFydFxyXG4gICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAyMDAwKSk7XHJcblxyXG4gICAgICAgIGlmIChjb21tYW5kLmluY2x1ZGVzKFwicmVzdGFydCByZWRpc1wiKSB8fCBjb21tYW5kLmluY2x1ZGVzKFwiZmx1c2hhbGxcIikpIHtcclxuICAgICAgICAgICAgQ1VSUkVOVF9TVEFURS5oZWFsdGh5ID0gdHJ1ZTtcclxuICAgICAgICAgICAgQ1VSUkVOVF9TVEFURS5hY3RpdmVJbmNpZGVudHMgPSBbXTtcclxuICAgICAgICAgICAgQ1VSUkVOVF9TVEFURS5jcHVVc2FnZSA9IDE1O1xyXG4gICAgICAgICAgICByZXR1cm4gXCJDb21tYW5kIGV4ZWN1dGVkIHN1Y2Nlc3NmdWxseS4gU2VydmljZSAncmVkaXMtc2VydmVyJyByZXN0YXJ0ZWQuIHN0ZG91dDogT0tcIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBgQ29tbWFuZCAnJHtjb21tYW5kfScgZXhlY3V0ZWQuIE5vIHNwZWNpZmljIHN0YXRlIGNoYW5nZSBkZXRlY3RlZC5gO1xyXG4gICAgfVxyXG59XHJcbiJdLAogICJtYXBwaW5ncyI6ICJBQWFBLElBQUksZ0JBQTZCO0FBQUEsRUFDN0IsU0FBUztBQUFBLEVBQ1QsaUJBQWlCLENBQUM7QUFBQSxFQUNsQixVQUFVO0FBQ2Q7QUFFTyxNQUFNLHNCQUFzQjtBQUFBO0FBQUE7QUFBQTtBQUFBLEVBSy9CLGFBQWEsZ0JBQStCO0FBQ3hDLFlBQVEsSUFBSSx5RUFBa0U7QUFDOUUsa0JBQWMsVUFBVTtBQUN4QixrQkFBYyxnQkFBZ0IsS0FBSywwQkFBMEI7QUFDN0Qsa0JBQWMsV0FBVztBQUFBLEVBQzdCO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQU1BLGFBQWEsZ0JBQWlDO0FBQzFDLFVBQU0sYUFBWSxvQkFBSSxLQUFLLEdBQUUsWUFBWTtBQUV6QyxRQUFJLGNBQWMsU0FBUztBQUN2QixhQUFPO0FBQUEsR0FDaEIsU0FBUztBQUFBLEdBQ1QsU0FBUztBQUFBLEdBQ1QsU0FBUztBQUFBLFFBQ0osS0FBSztBQUFBLElBQ0wsT0FBTztBQUNILGFBQU87QUFBQSxHQUNoQixTQUFTO0FBQUEsR0FDVCxTQUFTO0FBQUEsR0FDVCxTQUFTO0FBQUEsR0FDVCxTQUFTO0FBQUEsUUFDSixLQUFLO0FBQUEsSUFDTDtBQUFBLEVBQ0o7QUFBQTtBQUFBO0FBQUE7QUFBQSxFQUtBLGFBQWEsY0FBNEQ7QUFDckUsUUFBSSxjQUFjLFNBQVM7QUFDdkIsYUFBTyxFQUFFLFFBQVEsS0FBSyxTQUFTLEtBQUs7QUFBQSxJQUN4QyxPQUFPO0FBQ0gsYUFBTyxFQUFFLFFBQVEsS0FBSyxTQUFTLHNCQUFzQjtBQUFBLElBQ3pEO0FBQUEsRUFDSjtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsRUFNQSxhQUFhLGVBQWUsU0FBa0M7QUFDMUQsWUFBUSxJQUFJLGlEQUEwQyxPQUFPLEVBQUU7QUFHL0QsVUFBTSxJQUFJLFFBQVEsYUFBVyxXQUFXLFNBQVMsR0FBSSxDQUFDO0FBRXRELFFBQUksUUFBUSxTQUFTLGVBQWUsS0FBSyxRQUFRLFNBQVMsVUFBVSxHQUFHO0FBQ25FLG9CQUFjLFVBQVU7QUFDeEIsb0JBQWMsa0JBQWtCLENBQUM7QUFDakMsb0JBQWMsV0FBVztBQUN6QixhQUFPO0FBQUEsSUFDWDtBQUVBLFdBQU8sWUFBWSxPQUFPO0FBQUEsRUFDOUI7QUFDSjsiLAogICJuYW1lcyI6IFtdCn0K
